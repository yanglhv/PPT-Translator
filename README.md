# PPT-Translator
## 简介

一个将PPT用LLM能力实现的小翻译工具

本项目有前置要求:

1. 调用LLM的翻译能力
2. 调用PPT的COM接口获取文本信息
3. 输出结构化, 翻译后的文本要返回到PPT中, 进行替换

## 安装

```
$ pip install -r requirements.txt
建议使用venv或conda起一个新环境进行安装, 开发环境是python 3.10版本
```

## 使用

```
$ python winMain.py
1. 执行命令后会弹出主窗口, 先填入LLM的API配置信息(当前默认给了一个配置,但token有限,仅可用于demo)
2. 填完信息, 点击保存, 下次会自动填充本次提交的信息;
3. 单选要翻译为的语言;
4. 将PPT拖拽到下方执行框, 翻译子程序即开始运行(因为是调用LLM能力,输出会较慢);
5. 执行完成后会弹框, 显示翻译后的文件路径(原路径就地保存了)
```

API 的配置信息在讯飞官网获取: https://xinghuo.xfyun.cn/spark

## 实现逻辑

1. 翻译部分: 通过调用大模型(目前使用讯飞星火,在翻译方面在国内LLM做的较好, 官方提供了web接口, 需要鉴权等操作比较繁琐, 实现可参考SparkAPI项目), 给以调教好特定的提示词(比较费功夫), 让其将Text文本翻译为指定的文本; 

2. PPT的操作部分, 直接用pptx库, 逐一取出段落文本, 输入到上一步的翻译类, 得到输出结果, 回填到段落, 另存为新文件;

   (PS: pptx库中需要仔细理解paragraphs, 成体系的资料不多, 打断点调试看变量能更快了解原理)

3. 主界面部分:  直接使用Tkinter来做一个简单的界面, 将人机交互的操作和通知简单串接起来。
   (考虑到是趁手工具，要翻译的文件也都是本地PPT，故选择用本地exe程序。相比更熟悉的web应用，还是从头了解了一下python桌面界面框架Tkinter）



## 界面效果

![](https://github.com/yanglhv/PPT-Translator/blob/main/translator_showdemo.gif)



## 项目问题思考与解决

1. 时间匆忙, 仅做了极少的测试,  反向用例较少,  使用难免有问题,  如遇问题, 参考实现逻辑自行微调;
2. 初步看, 相较于直接调用翻译接口, 可以不用选择输入语言, 对多种语言的混合文本和特定专有词汇的理解能力要更强;
3. 当前是按段落来翻译的, 可以让LLM更加完整的识别上下文信息得到好一点的效果; 不过这是以牺牲部分样式(比如关键词的加粗/变色/斜体) 为代价的, 翻译后的句子中不再有单个词的样式效果;
4. 源码中提供了保持原样式的方法, 取消注释后运行即可, 但这对LLM的能力要求更高了, 需要仔细调整提示词逐一试探, 本项目就不就此细究了;
5. 零碎小问题: 组合文本框内层可能无法识别到文字, 部分词汇在LLM无法识别时或者干扰到LLM时, 会胡言乱语,解决起来比较耗精力,  暂时搁置, 遇到可以给我提ISSUE;
6. 最初考虑到LLM生成速度慢, IO是主要瓶颈, 想通过异步协程来解决, 但发现一般大模型能同时提供的并发请求也都很少(星火只支持2并发), 故为减少冗余, 未做异步处理;
7. 如有大批量文档翻译, 则依然建议使用专用的翻译API, 并使用按段落中的paragraphs.run的方式来翻译(见源码中批注), 能完全保持样式, 翻译速度也有保障; 
